"use strict";(self["webpackChunkfilefront"]=self["webpackChunkfilefront"]||[]).push([[414],{5188:function(e,l,a){a.d(l,{Z:function(){return m}});var o=a(6252),i=a(3577);const n={class:"table-container"},t={class:"search-wrap"},r={class:"table-wrap"},s={key:0,class:"pagination-wrap"};function d(e,l,a,d,c,u){const p=(0,o.up)("el-table-column"),g=(0,o.up)("el-tag"),m=(0,o.up)("el-button"),h=(0,o.up)("el-switch"),w=(0,o.up)("el-progress"),v=(0,o.up)("el-image"),b=(0,o.up)("el-table"),f=(0,o.up)("el-pagination"),C=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",t,[(0,o.WI)(e.$slots,"search")]),(0,o._)("div",r,[(0,o.wy)(((0,o.wg)(),(0,o.j4)(b,{data:a.data,border:"",stripe:"",size:"mini","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},"header-cell-style":a.headerCellStyle,"cell-style":e.cellStyle,onSelectionChange:e.onSelectionChange,style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.column,(l=>((0,o.wg)(),(0,o.iD)(o.HY,{key:l},[l.prop||l.label?"tag"==l.type?((0,o.wg)(),(0,o.j4)(p,{key:1,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,o.w5)((e=>[(0,o.Wm)(g,{size:l.option.size,effect:l.option.effect,type:l.option.type},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.row[l.prop]),1)])),_:2},1032,["size","effect","type"])])),_:2},1032,["label","align","width"])):"button"==l.type?((0,o.wg)(),(0,o.j4)(p,{key:2,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,o.w5)((a=>[(0,o.Wm)(m,{onClick:l=>e.$emit("onButtonClick",a.row),type:"text",size:l.option.size},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(a.row[l.prop]),1)])),_:2},1032,["onClick","size"])])),_:2},1032,["label","align","width"])):"switch"==l.type?((0,o.wg)(),(0,o.j4)(p,{key:3,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,o.w5)((a=>[(0,o.Wm)(h,{onChange:l=>e.$emit("onSwitchChange",a.row),"inline-prompt":"","active-value":l.option.activeValue,"active-color":l.option.activeColor,"active-text":l.option.activeText,"inactive-value":l.option.inactiveValue,"inactive-color":l.option.inactiveColor,"inactive-text":l.option.inactiveText,modelValue:a.row[l.prop],"onUpdate:modelValue":e=>a.row[l.prop]=e},null,8,["onChange","active-value","active-color","active-text","inactive-value","inactive-color","inactive-text","modelValue","onUpdate:modelValue"])])),_:2},1032,["label","align","width"])):"progress"==l.type?((0,o.wg)(),(0,o.j4)(p,{key:4,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,o.w5)((e=>[(0,o.Wm)(w,{percentage:e.row[l.prop],status:l.option.status,color:l.option.color},null,8,["percentage","status","color"])])),_:2},1032,["label","align","width"])):"img"==l.type?((0,o.wg)(),(0,o.j4)(p,{key:5,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,o.w5)((a=>[(0,o.Wm)(v,{style:{width:"50px",height:"50px"},src:e.imageUrlPrefix+a.row[l.prop],class:"head_pic"},null,8,["src"])])),_:2},1032,["label","align","width"])):((0,o.wg)(),(0,o.j4)(p,{key:6,"show-overflow-tooltip":"",prop:null==l.alias?l.prop:l.alias,label:l.label,align:null!=l.align?l.align:"center",width:l.width,fixed:l.fixed},null,8,["prop","label","align","width","fixed"])):((0,o.wg)(),(0,o.j4)(p,{key:0,fixed:l.fixed,type:"selection",width:"45"},null,8,["fixed"]))],64)))),128)),a.operation?((0,o.wg)(),(0,o.j4)(p,{key:0,fixed:"right",label:"操作",align:"center",width:"220"},{default:(0,o.w5)((l=>[(0,o.WI)(e.$slots,"column",{column:l})])),_:3})):(0,o.kq)("",!0)])),_:3},8,["data","header-cell-style","cell-style","onSelectionChange"])),[[C,a.loading]])]),a.page?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(f,{onSizeChange:e.onSizeChange,onCurrentChange:e.onCurrentChange,layout:"total, sizes, prev, pager, next, jumper","current-page":a.page.current,"page-sizes":[10,20,50,100],"page-size":a.page.size,total:a.page.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):(0,o.kq)("",!0)])}var c=a(2262),u={props:{loading:{type:Boolean,default:!1},page:{type:Object,default:{current:1,size:10,total:0}},column:{type:Array,default:[]},operation:{type:Boolean,default:!1},headerCellStyle:{type:Object,default:{color:"#606266",fontWeight:700,background:"var(--bg1)"}},data:{type:Array,default:[]}},emits:["onSizeChange","onCurrentChange","onSelectionChange","setCellColor","onButtonClick","onSwitchChange"],setup(e,l){const a=(0,c.qj)({cellStyle:function(e){let a={};return l.emit("setCellColor",e,((e={})=>{a=e})),a.padding="2px",a},imageUrlPrefix:(0,o.FN)()?.appContext.config.globalProperties.$imageUrl,onSizeChange:e=>{l.emit("onSizeChange",e)},onCurrentChange:e=>{l.emit("onCurrentChange",e)}});return{...(0,c.BK)(a)}}},p=a(3744);const g=(0,p.Z)(u,[["render",d]]);var m=g},2414:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});var o=a(6252);const i={class:"division"},n={class:"dialog-footer"};function t(e,l,a,t,r,s){const d=(0,o.up)("el-button"),c=(0,o.up)("el-col"),u=(0,o.up)("el-option"),p=(0,o.up)("el-select"),g=(0,o.up)("el-form-item"),m=(0,o.up)("el-row"),h=(0,o.up)("Table"),w=(0,o.up)("el-input"),v=(0,o.up)("el-switch"),b=(0,o.up)("el-form"),f=(0,o.up)("el-dialog"),C=(0,o.up)("el-card");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(C,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{data:e.tableData,column:e.tableTitle,operation:!0,page:e.page,loading:e.loading,onOnSizeChange:e.onSizeChange,onOnCurrentChange:e.onCurrentChange,onSetCellColor:e.setCellColor},{search:(0,o.w5)((()=>[(0,o.Wm)(m,{gutter:24},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{span:3},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{type:"primary",onClick:e.onAddDivision},{default:(0,o.w5)((()=>[(0,o.Uk)("添加支部")])),_:1},8,["onClick"])])),_:1}),(0,o.Wm)(c,{span:7},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{label:"新闻总部名："},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:e.searchForm.cno,"onUpdate:modelValue":l[0]||(l[0]=l=>e.searchForm.cno=l),placeholder:"请选择新闻总部",onChange:l[1]||(l[1]=l=>e.getAllBranchByCno(e.searchForm.cno)),style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.newsData,(e=>((0,o.wg)(),(0,o.j4)(u,{label:e.cname+"---"+e.tname,value:e.cno},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.Wm)(c,{span:7},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{label:"分部名称："},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:e.searchForm.branchNo,"onUpdate:modelValue":l[2]||(l[2]=l=>e.searchForm.branchNo=l),placeholder:"请选择分部名称",style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.branchData,(e=>((0,o.wg)(),(0,o.j4)(u,{label:e.branchName,value:e.branchNo},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.Wm)(c,{span:7},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onClick:e.onRefresh,icon:"RefreshRight",circle:""},null,8,["onClick"]),(0,o.Wm)(d,{onClick:e.onSearch,type:"primary",icon:"Search"},{default:(0,o.w5)((()=>[(0,o.Uk)("查询")])),_:1},8,["onClick"])])),_:1})])),_:1})])),column:(0,o.w5)((l=>[(0,o.Wm)(d,{onClick:a=>e.onEdit(l),type:"text",style:{color:"var(--edit)"}},{default:(0,o.w5)((()=>[(0,o.Uk)("编辑")])),_:2},1032,["onClick"]),(0,o.Wm)(d,{onClick:a=>e.onDelete(l),type:"text",style:{color:"var(--delete)"}},{default:(0,o.w5)((()=>[(0,o.Uk)("删除")])),_:2},1032,["onClick"])])),_:1},8,["data","column","page","loading","onOnSizeChange","onOnCurrentChange","onSetCellColor"]),(0,o.Wm)(f,{title:e.divisionTitle,modelValue:e.divisionVisible,"onUpdate:modelValue":l[9]||(l[9]=l=>e.divisionVisible=l),"show-close":!1},{footer:(0,o.w5)((()=>[(0,o._)("span",n,[(0,o.Wm)(d,{onClick:l[8]||(l[8]=l=>e.divisionVisible=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)("取消")])),_:1}),(0,o.Wm)(d,{type:"primary",onClick:e.onSubmit},{default:(0,o.w5)((()=>[(0,o.Uk)("提交")])),_:1},8,["onClick"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(b,{model:e.divisionForm,rules:e.rules,ref:"divisionRuleForm","status-icon":"","label-width":"100px"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{prop:"cno",label:"新闻总部名",rules:[{required:!0,message:"请选择新闻总部",trigger:"blur"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:e.divisionForm.cno,"onUpdate:modelValue":l[3]||(l[3]=l=>e.divisionForm.cno=l),onChange:l[4]||(l[4]=l=>e.getAllBranchByCno1(e.divisionForm.cno)),placeholder:"请选择新闻总部",style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.newsData,(e=>((0,o.wg)(),(0,o.j4)(u,{label:e.cname+"---"+e.tname,value:e.cno},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(g,{prop:"cno",label:"分部名",rules:[{required:!0,message:"请选择分部",trigger:"blur"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:e.divisionForm.branchNo,"onUpdate:modelValue":l[5]||(l[5]=l=>e.divisionForm.branchNo=l),placeholder:"请选择分部",style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.branchData1,(e=>((0,o.wg)(),(0,o.j4)(u,{label:e.branchName,value:e.branchNo},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(g,{prop:"divisionName",label:"支部名",rules:[{required:!0,message:"请输入支部",trigger:"blur"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{modelValue:e.divisionForm.divisionName,"onUpdate:modelValue":l[6]||(l[6]=l=>e.divisionForm.divisionName=l),placeholder:"请输入分部名"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(g,{prop:"enabled",label:"是否启用",rules:[{required:!0,message:"是否启用",trigger:"blur"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{modelValue:e.divisionForm.enabled,"onUpdate:modelValue":l[7]||(l[7]=l=>e.divisionForm.enabled=l),class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])}var r=a(2262),s=a(1348),d=a(9737),c=a(5188),u=a(9669),p=a.n(u),g={props:{},components:{Table:c.Z},setup(){(0,o.bv)((async()=>{await e.onNews(),await e.getAllBranchByCno(e.searchForm.cno),await e.onDivisionPage()}));const e=(0,r.qj)({searchForm:{cno:null,branchNo:null},typeData:[],loading:!1,page:{current:1,size:10,total:1},newsData:[],branchData:[],branchData1:[],tableTitle:[{prop:"",label:"",fixed:"left"},{prop:"divisionNo",label:"分部id"},{prop:"newsName",label:"新闻总部名"},{prop:"branchName",label:"分部名"},{prop:"divisionName",label:"支部名"},{prop:"enabled",label:"是否启用"}],tableData:[],divisionRuleForm:(0,r.iH)(null),typeLoading:!1,divisionVisible:!1,divisionTitle:"添加支部",operate:0,divisionForm:{divisionNo:"",cno:"",branchNo:"",divisionName:"",enabled:!0},orgData:[],divisionList:[],uploadRef:(0,r.iH)(null),imageUrlPrefix:(0,o.FN)()?.appContext.config.globalProperties.$imageUrl,onDivisionPage:async()=>{if(e.loading=!0,!e.searchForm.cno||!e.searchForm.branchNo)return e.tableData=[],void(e.loading=!1);await p().get("/division/getDivisionList",{params:Object.assign(e.page,e.searchForm)}).then((l=>{e.loading=!1,e.tableData=l.data.result.list,e.page.current=l.data.result.pageNum,e.page.size=l.data.result.pageSize,e.page.total=l.data.result.total}))},onNews:async()=>{await p().get("/news/getAllNews").then((l=>{e.newsData=l.data.result,l.data.result[0]&&(e.searchForm.cno=l.data.result[0].cno)}))},getAllBranchByCno1:async l=>{e.loading=!0,l&&(e.divisionForm.branchNo="",await p().get("/branch/getAllBranch",{params:{cno:l}}).then((l=>{e.loading=!1,e.branchData1=l.data.result,l.data.result[0]&&(e.divisionForm.branchNo=l.data.result[0].branchNo)})))},getAllBranchByCno:async l=>{e.loading=!0,l&&(e.searchForm.branchNo="",await p().get("/branch/getAllBranch",{params:{cno:l}}).then((l=>{e.loading=!1,e.branchData=l.data.result,l.data.result[0]&&(e.searchForm.branchNo=l.data.result[0].branchNo)})))},onSearch:()=>{e.onDivisionPage()},onRefresh:()=>{e.searchForm={cname:null},e.onDivisionPage()},onSizeChange:l=>{e.page.size=l,e.onDivisionPage()},onCurrentChange:l=>{e.page.current=l,e.onDivisionPage()},onAddDivision:()=>{e.userTitle="添加分部类型",e.operate=0,e.divisionForm={divisionNo:"",cno:"",branchNo:"",divisionName:"",enabled:!0},e.divisionVisible=!0},onEdit:l=>{e.userTitle="修改分部",e.operate=1,e.getAllBranchByCno1(l.column.row.cno),e.divisionForm={divisionNo:l.column.row.divisionNo,branchNo:l.column.row.branchNo,divisionName:l.column.row.divisionName,cno:l.column.row.cno,enabled:l.column.row.enabled},e.divisionVisible=!0},onSubmit:async()=>{const l=e.divisionRuleForm;l&&(await l.validate(),0==e.operate?p().post("/division/divisionSave",e.divisionForm).then((l=>{l.data.result&&(s.z8.success({message:"添加成功！",type:"success"}),e.onDivisionPage(),e.divisionVisible=!1)})):p().post("/division/divisionUpdate",e.divisionForm).then((l=>{l.data.result&&(s.z8.success({message:"修改成功！",type:"success"}),e.onDivisionPage(),e.divisionVisible=!1)})))},onDelete:l=>{d.T.confirm("此操作将永久删除该分部, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let a={divisionId:l.column.row.divisionId};p().get("/division/divisionDelete",{params:a}).then((l=>{l.data.result&&(s.z8.success("删除成功!"),e.onDivisionPage())}))})).catch((e=>{console.log(e)}))},upload:l=>{var a=l.division,o=new FormData;o.append("mydivision",a),p().post("upload",o).then((l=>{e.divisionForm.divisionUrl=l.data.result,s.z8.success({message:"上传成功",type:"success"})})).catch((e=>{console.log(e)}))}});return{...(0,r.BK)(e)}}},m=a(3744);const h=(0,m.Z)(g,[["render",t]]);var w=h}}]);
//# sourceMappingURL=414.5a1e78d3.js.map