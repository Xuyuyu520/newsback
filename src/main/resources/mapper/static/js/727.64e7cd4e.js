"use strict";(self["webpackChunkfilefront"]=self["webpackChunkfilefront"]||[]).push([[727],{5188:function(e,a,l){l.d(a,{Z:function(){return g}});var n=l(6252),t=l(3577);const o={class:"table-container"},r={class:"search-wrap"},i={class:"table-wrap"},c={key:0,class:"pagination-wrap"};function u(e,a,l,u,s,p){const h=(0,n.up)("el-table-column"),d=(0,n.up)("el-tag"),g=(0,n.up)("el-button"),m=(0,n.up)("el-switch"),b=(0,n.up)("el-progress"),w=(0,n.up)("el-image"),f=(0,n.up)("el-table"),C=(0,n.up)("el-pagination"),y=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.iD)("div",o,[(0,n._)("div",r,[(0,n.WI)(e.$slots,"search")]),(0,n._)("div",i,[(0,n.wy)(((0,n.wg)(),(0,n.j4)(f,{data:l.data,border:"",stripe:"",size:"mini","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},"header-cell-style":l.headerCellStyle,"cell-style":e.cellStyle,onSelectionChange:e.onSelectionChange,style:{width:"100%"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.column,(a=>((0,n.wg)(),(0,n.iD)(n.HY,{key:a},[a.prop||a.label?"tag"==a.type?((0,n.wg)(),(0,n.j4)(h,{key:1,"show-overflow-tooltip":"",label:a.label,align:null!=a.align?a.align:"center",width:a.width},{default:(0,n.w5)((e=>[(0,n.Wm)(d,{size:a.option.size,effect:a.option.effect,type:a.option.type},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.row[a.prop]),1)])),_:2},1032,["size","effect","type"])])),_:2},1032,["label","align","width"])):"button"==a.type?((0,n.wg)(),(0,n.j4)(h,{key:2,"show-overflow-tooltip":"",label:a.label,align:null!=a.align?a.align:"center",width:a.width},{default:(0,n.w5)((l=>[(0,n.Wm)(g,{onClick:a=>e.$emit("onButtonClick",l.row),type:"text",size:a.option.size},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(l.row[a.prop]),1)])),_:2},1032,["onClick","size"])])),_:2},1032,["label","align","width"])):"switch"==a.type?((0,n.wg)(),(0,n.j4)(h,{key:3,"show-overflow-tooltip":"",label:a.label,align:null!=a.align?a.align:"center",width:a.width},{default:(0,n.w5)((l=>[(0,n.Wm)(m,{onChange:a=>e.$emit("onSwitchChange",l.row),"inline-prompt":"","active-value":a.option.activeValue,"active-color":a.option.activeColor,"active-text":a.option.activeText,"inactive-value":a.option.inactiveValue,"inactive-color":a.option.inactiveColor,"inactive-text":a.option.inactiveText,modelValue:l.row[a.prop],"onUpdate:modelValue":e=>l.row[a.prop]=e},null,8,["onChange","active-value","active-color","active-text","inactive-value","inactive-color","inactive-text","modelValue","onUpdate:modelValue"])])),_:2},1032,["label","align","width"])):"progress"==a.type?((0,n.wg)(),(0,n.j4)(h,{key:4,"show-overflow-tooltip":"",label:a.label,align:null!=a.align?a.align:"center",width:a.width},{default:(0,n.w5)((e=>[(0,n.Wm)(b,{percentage:e.row[a.prop],status:a.option.status,color:a.option.color},null,8,["percentage","status","color"])])),_:2},1032,["label","align","width"])):"img"==a.type?((0,n.wg)(),(0,n.j4)(h,{key:5,"show-overflow-tooltip":"",label:a.label,align:null!=a.align?a.align:"center",width:a.width},{default:(0,n.w5)((l=>[(0,n.Wm)(w,{style:{width:"50px",height:"50px"},src:e.imageUrlPrefix+l.row[a.prop],class:"head_pic"},null,8,["src"])])),_:2},1032,["label","align","width"])):((0,n.wg)(),(0,n.j4)(h,{key:6,"show-overflow-tooltip":"",prop:null==a.alias?a.prop:a.alias,label:a.label,align:null!=a.align?a.align:"center",width:a.width,fixed:a.fixed},null,8,["prop","label","align","width","fixed"])):((0,n.wg)(),(0,n.j4)(h,{key:0,fixed:a.fixed,type:"selection",width:"45"},null,8,["fixed"]))],64)))),128)),l.operation?((0,n.wg)(),(0,n.j4)(h,{key:0,fixed:"right",label:"操作",align:"center",width:"220"},{default:(0,n.w5)((a=>[(0,n.WI)(e.$slots,"column",{column:a})])),_:3})):(0,n.kq)("",!0)])),_:3},8,["data","header-cell-style","cell-style","onSelectionChange"])),[[y,l.loading]])]),l.page?((0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(C,{onSizeChange:e.onSizeChange,onCurrentChange:e.onCurrentChange,layout:"total, sizes, prev, pager, next, jumper","current-page":l.page.current,"page-sizes":[10,20,50,100],"page-size":l.page.size,total:l.page.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):(0,n.kq)("",!0)])}var s=l(2262),p={props:{loading:{type:Boolean,default:!1},page:{type:Object,default:{current:1,size:10,total:0}},column:{type:Array,default:[]},operation:{type:Boolean,default:!1},headerCellStyle:{type:Object,default:{color:"#606266",fontWeight:700,background:"var(--bg1)"}},data:{type:Array,default:[]}},emits:["onSizeChange","onCurrentChange","onSelectionChange","setCellColor","onButtonClick","onSwitchChange"],setup(e,a){const l=(0,s.qj)({cellStyle:function(e){let l={};return a.emit("setCellColor",e,((e={})=>{l=e})),l.padding="2px",l},imageUrlPrefix:(0,n.FN)()?.appContext.config.globalProperties.$imageUrl,onSizeChange:e=>{a.emit("onSizeChange",e)},onCurrentChange:e=>{a.emit("onCurrentChange",e)}});return{...(0,s.BK)(l)}}},h=l(3744);const d=(0,h.Z)(p,[["render",u]]);var g=d},6727:function(e,a,l){l.r(a),l.d(a,{default:function(){return b}});var n=l(6252);const t={class:"branch"},o={class:"dialog-footer"};function r(e,a,l,r,i,c){const u=(0,n.up)("el-button"),s=(0,n.up)("el-col"),p=(0,n.up)("el-option"),h=(0,n.up)("el-select"),d=(0,n.up)("el-form-item"),g=(0,n.up)("el-row"),m=(0,n.up)("Table"),b=(0,n.up)("el-input"),w=(0,n.up)("el-switch"),f=(0,n.up)("el-form"),C=(0,n.up)("el-dialog"),y=(0,n.up)("el-card");return(0,n.wg)(),(0,n.iD)("div",t,[(0,n.Wm)(y,null,{default:(0,n.w5)((()=>[(0,n.Wm)(m,{data:e.tableData,column:e.tableTitle,operation:!0,page:e.page,loading:e.loading,onOnSizeChange:e.onSizeChange,onOnCurrentChange:e.onCurrentChange,onSetCellColor:e.setCellColor},{search:(0,n.w5)((()=>[(0,n.Wm)(g,{gutter:24},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{span:4},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{type:"primary",onClick:e.onAddBranch},{default:(0,n.w5)((()=>[(0,n.Uk)("添加分部")])),_:1},8,["onClick"])])),_:1}),(0,n.Wm)(s,{span:12},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{label:"新闻总部名："},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{modelValue:e.searchForm.cno,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchForm.cno=a),placeholder:"请选择新闻总部",style:{width:"100%"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.newsData,(e=>((0,n.wg)(),(0,n.j4)(p,{label:e.cname+"---"+e.tname,value:e.cno},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,n.Wm)(s,{span:7},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{onClick:e.onRefresh,icon:"RefreshRight",circle:""},null,8,["onClick"]),(0,n.Wm)(u,{onClick:e.onSearch,type:"primary",icon:"Search"},{default:(0,n.w5)((()=>[(0,n.Uk)("查询")])),_:1},8,["onClick"])])),_:1})])),_:1})])),column:(0,n.w5)((a=>[(0,n.Wm)(u,{onClick:l=>e.onEdit(a),type:"text",style:{color:"var(--edit)"}},{default:(0,n.w5)((()=>[(0,n.Uk)("编辑")])),_:2},1032,["onClick"]),(0,n.Wm)(u,{onClick:l=>e.onDelete(a),type:"text",style:{color:"var(--delete)"}},{default:(0,n.w5)((()=>[(0,n.Uk)("删除")])),_:2},1032,["onClick"])])),_:1},8,["data","column","page","loading","onOnSizeChange","onOnCurrentChange","onSetCellColor"]),(0,n.Wm)(C,{title:e.branchTitle,modelValue:e.branchVisible,"onUpdate:modelValue":a[5]||(a[5]=a=>e.branchVisible=a),"show-close":!1},{footer:(0,n.w5)((()=>[(0,n._)("span",o,[(0,n.Wm)(u,{onClick:a[4]||(a[4]=a=>e.branchVisible=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1}),(0,n.Wm)(u,{type:"primary",onClick:e.onSubmit},{default:(0,n.w5)((()=>[(0,n.Uk)("提交")])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[(0,n.Wm)(f,{model:e.branchForm,rules:e.rules,ref:"branchRuleForm","status-icon":"","label-width":"100px"},{default:(0,n.w5)((()=>[0==e.operate?((0,n.wg)(),(0,n.j4)(d,{key:0,prop:"cno",label:"新闻总部名",rules:[{required:!0,message:"请选择新闻总部",trigger:"blur"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{modelValue:e.branchForm.cno,"onUpdate:modelValue":a[1]||(a[1]=a=>e.branchForm.cno=a),placeholder:"请选择新闻总部",style:{width:"100%"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.newsData,(e=>((0,n.wg)(),(0,n.j4)(p,{label:e.cname+"---"+e.tname,value:e.cno},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(d,{prop:"branchName",label:"分部名",rules:[{required:!0,message:"请输入支部名",trigger:"blur"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{modelValue:e.branchForm.branchName,"onUpdate:modelValue":a[2]||(a[2]=a=>e.branchForm.branchName=a),placeholder:"请输入分部名"},null,8,["modelValue"])])),_:1}),(0,n.Wm)(d,{prop:"enabled",label:"是否启用",rules:[{required:!0,message:"是否启用",trigger:"blur"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{modelValue:e.branchForm.enabled,"onUpdate:modelValue":a[3]||(a[3]=a=>e.branchForm.enabled=a),class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])}l(7658);var i=l(2262),c=l(1348),u=l(9737),s=l(5188),p=l(9669),h=l.n(p),d={props:{},components:{Table:s.Z},setup(){(0,n.bv)((()=>{e.onNews()}));const e=(0,i.qj)({searchForm:{cno:null},typeData:[],loading:!1,page:{current:1,size:10,total:1},newsData:[],tableTitle:[{prop:"",label:"",fixed:"left"},{prop:"branchNo",label:"分部id"},{prop:"newsName",label:"新闻总部名"},{prop:"branchName",label:"分部名"},{prop:"enabled",label:"是否启用"}],tableData:[],branchRuleForm:(0,i.iH)(null),typeLoading:!1,branchVisible:!1,branchTitle:"添加分部",operate:0,branchForm:{branchNo:"",cno:"",branchName:"",enabled:!0},orgData:[],branchList:[],uploadRef:(0,i.iH)(null),imageUrlPrefix:(0,n.FN)()?.appContext.config.globalProperties.$imageUrl,onBranchPage:()=>{e.loading=!0,h().get("/branch/getBranchList",{params:Object.assign(e.page,e.searchForm)}).then((a=>{e.loading=!1,e.tableData=a.data.result.list,e.page.current=a.data.result.pageNum,e.page.size=a.data.result.pageSize,e.page.total=a.data.result.total}))},onNews:()=>{h().get("/news/getAllNews").then((a=>{e.newsData=a.data.result,a.data.result[0]&&(e.searchForm.cno=a.data.result[0].cno,e.onBranchPage())}))},onSearch:()=>{e.onBranchPage()},onRefresh:()=>{e.searchForm={cname:null},e.onBranchPage()},onSizeChange:a=>{e.page.size=a,e.onBranchPage()},onCurrentChange:a=>{e.page.current=a,e.onBranchPage()},onAddBranch:()=>{e.userTitle="添加分部类型",e.operate=0,e.branchForm={branchNo:"",cno:"",branchName:"",enabled:!0},e.branchVisible=!0},onEdit:a=>{e.userTitle="修改分部类型",e.operate=1,e.branchForm={branchNo:a.column.row.branchNo,branchName:a.column.row.branchName,cno:a.column.row.cno,enabled:a.column.row.enabled},e.branchList=[],e.branchList.push({name:"分部图片",url:e.imageUrl+e.branchForm.branchUrl}),e.branchVisible=!0},onSubmit:async()=>{const a=e.branchRuleForm;a&&(await a.validate(),0==e.operate?h().post("/branch/branchSave",e.branchForm).then((a=>{a.data.result&&(c.z8.success({message:"添加成功！",type:"success"}),e.onBranchPage(),e.branchVisible=!1)})):h().post("/branch/branchUpdate",e.branchForm).then((a=>{a.data.result&&(c.z8.success({message:"修改成功！",type:"success"}),e.onBranchPage(),e.branchVisible=!1)})))},onDelete:a=>{u.T.confirm("此操作将永久删除该分部, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let l={branchId:a.column.row.branchId};h().get("/branch/branchDelete",{params:l}).then((a=>{a.data.result&&(c.z8.success("删除成功!"),e.onBranchPage())}))})).catch((e=>{console.log(e)}))},upload:a=>{var l=a.branch,n=new FormData;n.append("mybranch",l),h().post("upload",n).then((a=>{e.branchForm.branchUrl=a.data.result,c.z8.success({message:"上传成功",type:"success"})})).catch((e=>{console.log(e)}))}});return{...(0,i.BK)(e)}}},g=l(3744);const m=(0,g.Z)(d,[["render",r]]);var b=m}}]);
//# sourceMappingURL=727.64e7cd4e.js.map