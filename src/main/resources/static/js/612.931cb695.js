"use strict";(self["webpackChunkfilefront"]=self["webpackChunkfilefront"]||[]).push([[612],{2648:function(e,l,t){t.d(l,{f2:function(){return a}});t(7658);function a(e){var l=new Date(e).getFullYear(),t=new Date(e).getMonth()+1<10?"0"+(new Date(e).getMonth()+1):new Date(e).getMonth()+1,a=new Date(e).getDate()<10?"0"+new Date(e).getDate():new Date(e).getDate(),o=new Date(e).getHours()<10?"0"+new Date(e).getHours():new Date(e).getHours(),r=new Date(e).getMinutes()<10?"0"+new Date(e).getMinutes():new Date(e).getMinutes(),i=new Date(e).getSeconds()<10?"0"+new Date(e).getSeconds():new Date(e).getSeconds();return l+"年"+t+"月"+a+"日"+o+"时"+r+"分"+i+"秒"}},5188:function(e,l,t){t.d(l,{Z:function(){return m}});var a=t(6252),o=t(3577);const r={class:"table-container"},i={class:"search-wrap"},n={class:"table-wrap"},c={key:0,class:"pagination-wrap"};function u(e,l,t,u,p,d){const s=(0,a.up)("el-table-column"),g=(0,a.up)("el-tag"),m=(0,a.up)("el-button"),w=(0,a.up)("el-switch"),h=(0,a.up)("el-progress"),f=(0,a.up)("el-image"),b=(0,a.up)("el-table"),y=(0,a.up)("el-pagination"),C=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",i,[(0,a.WI)(e.$slots,"search")]),(0,a._)("div",n,[(0,a.wy)(((0,a.wg)(),(0,a.j4)(b,{data:t.data,border:"",stripe:"",size:"mini","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},"header-cell-style":t.headerCellStyle,"cell-style":e.cellStyle,onSelectionChange:e.onSelectionChange,style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.column,(l=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[l.prop||l.label?"tag"==l.type?((0,a.wg)(),(0,a.j4)(s,{key:1,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,a.w5)((e=>[(0,a.Wm)(g,{size:l.option.size,effect:l.option.effect,type:l.option.type},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row[l.prop]),1)])),_:2},1032,["size","effect","type"])])),_:2},1032,["label","align","width"])):"button"==l.type?((0,a.wg)(),(0,a.j4)(s,{key:2,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,a.w5)((t=>[(0,a.Wm)(m,{onClick:l=>e.$emit("onButtonClick",t.row),type:"text",size:l.option.size},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(t.row[l.prop]),1)])),_:2},1032,["onClick","size"])])),_:2},1032,["label","align","width"])):"switch"==l.type?((0,a.wg)(),(0,a.j4)(s,{key:3,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,a.w5)((t=>[(0,a.Wm)(w,{onChange:l=>e.$emit("onSwitchChange",t.row),"inline-prompt":"","active-value":l.option.activeValue,"active-color":l.option.activeColor,"active-text":l.option.activeText,"inactive-value":l.option.inactiveValue,"inactive-color":l.option.inactiveColor,"inactive-text":l.option.inactiveText,modelValue:t.row[l.prop],"onUpdate:modelValue":e=>t.row[l.prop]=e},null,8,["onChange","active-value","active-color","active-text","inactive-value","inactive-color","inactive-text","modelValue","onUpdate:modelValue"])])),_:2},1032,["label","align","width"])):"progress"==l.type?((0,a.wg)(),(0,a.j4)(s,{key:4,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,a.w5)((e=>[(0,a.Wm)(h,{percentage:e.row[l.prop],status:l.option.status,color:l.option.color},null,8,["percentage","status","color"])])),_:2},1032,["label","align","width"])):"img"==l.type?((0,a.wg)(),(0,a.j4)(s,{key:5,"show-overflow-tooltip":"",label:l.label,align:null!=l.align?l.align:"center",width:l.width},{default:(0,a.w5)((t=>[(0,a.Wm)(f,{style:{width:"50px",height:"50px"},src:e.imageUrlPrefix+t.row[l.prop],class:"head_pic"},null,8,["src"])])),_:2},1032,["label","align","width"])):((0,a.wg)(),(0,a.j4)(s,{key:6,"show-overflow-tooltip":"",prop:null==l.alias?l.prop:l.alias,label:l.label,align:null!=l.align?l.align:"center",width:l.width,fixed:l.fixed},null,8,["prop","label","align","width","fixed"])):((0,a.wg)(),(0,a.j4)(s,{key:0,fixed:l.fixed,type:"selection",width:"45"},null,8,["fixed"]))],64)))),128)),t.operation?((0,a.wg)(),(0,a.j4)(s,{key:0,fixed:"right",label:"操作",align:"center",width:"220"},{default:(0,a.w5)((l=>[(0,a.WI)(e.$slots,"column",{column:l})])),_:3})):(0,a.kq)("",!0)])),_:3},8,["data","header-cell-style","cell-style","onSelectionChange"])),[[C,t.loading]])]),t.page?((0,a.wg)(),(0,a.iD)("div",c,[(0,a.Wm)(y,{onSizeChange:e.onSizeChange,onCurrentChange:e.onCurrentChange,layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.current,"page-sizes":[10,20,50,100],"page-size":t.page.size,total:t.page.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):(0,a.kq)("",!0)])}var p=t(2262),d={props:{loading:{type:Boolean,default:!1},page:{type:Object,default:{current:1,size:10,total:0}},column:{type:Array,default:[]},operation:{type:Boolean,default:!1},headerCellStyle:{type:Object,default:{color:"#606266",fontWeight:700,background:"var(--bg1)"}},data:{type:Array,default:[]}},emits:["onSizeChange","onCurrentChange","onSelectionChange","setCellColor","onButtonClick","onSwitchChange"],setup(e,l){const t=(0,p.qj)({cellStyle:function(e){let t={};return l.emit("setCellColor",e,((e={})=>{t=e})),t.padding="2px",t},imageUrlPrefix:(0,a.FN)()?.appContext.config.globalProperties.$imageUrl,onSizeChange:e=>{l.emit("onSizeChange",e)},onCurrentChange:e=>{l.emit("onCurrentChange",e)}});return{...(0,p.BK)(t)}}},s=t(3744);const g=(0,s.Z)(d,[["render",u]]);var m=g},2612:function(e,l,t){t.r(l),t.d(l,{default:function(){return f}});var a=t(6252);const o={class:"article"},r=["src"],i={class:"dialog-footer"};function n(e,l,t,n,c,u){const p=(0,a.up)("el-button"),d=(0,a.up)("el-col"),s=(0,a.up)("el-input"),g=(0,a.up)("el-form-item"),m=(0,a.up)("el-row"),w=(0,a.up)("el-upload"),h=(0,a.up)("Document"),f=(0,a.up)("Table"),b=(0,a.up)("Plus"),y=(0,a.up)("el-icon"),C=(0,a.up)("el-option"),v=(0,a.up)("el-select"),k=(0,a.up)("el-form"),U=(0,a.up)("el-dialog"),W=(0,a.up)("el-card");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{data:e.tableData,column:e.tableTitle,operation:!0,page:e.page,loading:e.loading,onOnSizeChange:e.onSizeChange,onOnCurrentChange:e.onCurrentChange,onSetCellColor:e.setCellColor},{search:(0,a.w5)((()=>[(0,a.Wm)(m,{gutter:24},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"primary",onClick:e.onAddArticle},{default:(0,a.w5)((()=>[(0,a.Uk)("添加新闻")])),_:1},8,["onClick"])])),_:1}),(0,a.Wm)(d,{span:7},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{label:"新闻名"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.searchForm.articleName,"onUpdate:modelValue":l[0]||(l[0]=l=>e.searchForm.articleName=l),placeholder:"请输入新闻名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(d,{span:7,label:"作者"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{label:"新闻名"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.searchForm.author,"onUpdate:modelValue":l[1]||(l[1]=l=>e.searchForm.author=l),placeholder:"请输入新闻作者"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(d,{span:6},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:e.onRefresh,icon:"RefreshRight",circle:""},null,8,["onClick"]),(0,a.Wm)(p,{onClick:e.onSearch,type:"primary",icon:"Search"},{default:(0,a.w5)((()=>[(0,a.Uk)("查询")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,a.Wm)(m,{gutter:24},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:8},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:e.exportOut,type:"primary",icon:"Download",style:{"margin-bottom":"7px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("导出excel ")])),_:1},8,["onClick"])])),_:1}),(0,a.Wm)(d,{span:8},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{ref:"fileUploadButton",httpRequest:e.exportIn,"show-file-list":!1,"auto-upload":"true",class:"upload-demo",limit:1},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"primary",icon:"Upload"},{default:(0,a.w5)((()=>[(0,a.Uk)("批量新增")])),_:1})])),_:1},8,["httpRequest"])])),_:1}),(0,a.Wm)(d,{span:8},{default:(0,a.w5)((()=>[(0,a._)("a",{style:{color:"red",cursor:"pointer"},onClick:l[2]||(l[2]=(...l)=>e.downLoadTemplate&&e.downLoadTemplate(...l))},[(0,a.Wm)(h,{style:{width:"15px",height:"15px"}}),(0,a.Uk)(" 模板下载")])])),_:1})])),_:1})])),column:(0,a.w5)((l=>[(0,a.Wm)(p,{onClick:t=>e.onEdit(l),type:"text",style:{color:"var(--edit)"}},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(p,{onClick:t=>e.onDelete(l),type:"text",style:{color:"var(--delete)"}},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:2},1032,["onClick"])])),_:1},8,["data","column","page","loading","onOnSizeChange","onOnCurrentChange","onSetCellColor"]),(0,a.Wm)(U,{title:e.articleTitle,modelValue:e.articleVisible,"onUpdate:modelValue":l[9]||(l[9]=l=>e.articleVisible=l),"show-close":!1},{footer:(0,a.w5)((()=>[(0,a._)("span",i,[(0,a.Wm)(p,{onClick:l[8]||(l[8]=l=>e.articleVisible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1}),(0,a.Wm)(p,{type:"primary",onClick:e.onSubmit},{default:(0,a.w5)((()=>[(0,a.Uk)("提交")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(k,{model:e.articleForm,rules:e.rules,ref:"articleRuleForm","status-icon":"","label-width":"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{prop:"articleName",label:"新闻名",rules:[{required:!0,message:"请输入新闻名",trigger:"blur"}]},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.articleForm.articleName,"onUpdate:modelValue":l[3]||(l[3]=l=>e.articleForm.articleName=l),placeholder:"请输入新闻名"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(g,{label:"图片"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"avatar-uploader",httpRequest:e.uploadImg,"show-file-list":!1,"auto-upload":"true"},{default:(0,a.w5)((()=>[e.articleForm.articleUrl?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.imageUrlPrefix+e.articleForm.articleUrl,class:"avatar",style:{width:"178px",height:"178px"}},null,8,r)):((0,a.wg)(),(0,a.j4)(y,{key:1,class:"avatar-uploader-icon"},{default:(0,a.w5)((()=>[(0,a.Wm)(b)])),_:1}))])),_:1},8,["httpRequest"])])),_:1}),(0,a.Wm)(g,{prop:"author",label:"作者",rules:[{required:!0,message:"请输入作者",trigger:"blur"}]},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.articleForm.author,"onUpdate:modelValue":l[4]||(l[4]=l=>e.articleForm.author=l),placeholder:"请输入作者"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(g,{prop:"type",label:"类型",rules:[{required:!0,message:"请输入类型",trigger:"blur"}]},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{modelValue:e.articleForm.type,"onUpdate:modelValue":l[5]||(l[5]=l=>e.articleForm.type=l),placeholder:"请选择类型",style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.typeData,(e=>((0,a.wg)(),(0,a.j4)(C,{key:e.typeId,label:e.cname,value:e.typeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(g,{prop:"price",label:"价格",rules:[{required:!0,message:"请输入价格",trigger:"blur"},{pattern:/(^[1-9][0-9]{0,8}(\.[0-9]{1,2})?$)|(^0(\.[0-9]{1,2})?$)/,message:"价格只能是数字且不能有空格,只能带两位小数",trigger:"blur"}]},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.articleForm.price,"onUpdate:modelValue":l[6]||(l[6]=l=>e.articleForm.price=l),placeholder:"请输入价格"},null,8,["modelValue"])])),_:1},8,["rules"]),(0,a.Wm)(g,{prop:"count",label:"数量",rules:[{required:!0,message:"数量",trigger:"blur"},{pattern:/^[1-9][0-9]{0,9}$/,message:"数量只能是数字且不能有空格,长度不能超过10位",trigger:"blur"}]},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.articleForm.count,"onUpdate:modelValue":l[7]||(l[7]=l=>e.articleForm.count=l),placeholder:"请输入数量"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])}t(7658);var c=t(2262),u=t(1348),p=t(9737),d=t(5188),s=(t(2648),t(9669)),g=t.n(s),m={props:{},components:{Table:d.Z},setup(){(0,a.bv)((()=>{e.onArticlePage(),e.onCategory()}));const e=(0,c.qj)({searchForm:{articleName:null,author:null},typeData:[],loading:!1,page:{current:1,size:10,total:1},tableTitle:[{prop:"",label:"",fixed:"left"},{prop:"articleId",label:"新闻id"},{prop:"articleName",label:"新闻名"},{prop:"articleUrl",label:"新闻图片",type:"img"},{prop:"author",label:"作者"},{prop:"type",label:"类型",alias:"typeName"},{prop:"price",label:"价格"},{prop:"count",label:"数量"}],tableData:[],articleRuleForm:(0,c.iH)(null),typeLoading:!1,articleVisible:!1,articleTitle:"添加新闻",operate:0,articleForm:{articleId:"",articleName:"",articleUrl:"",author:"",type:"",price:"",count:""},orgData:[],fileList:[],uploadRef:(0,c.iH)(null),imageUrlPrefix:(0,a.FN)()?.appContext.config.globalProperties.$imageUrl,onArticlePage:()=>{e.loading=!0,g().get("/article/getArticleList",{params:Object.assign(e.page,e.searchForm)}).then((l=>{e.loading=!1,e.tableData=l.data.result.list,e.page.current=l.data.result.pageNum,e.page.size=l.data.result.pageSize,e.page.total=l.data.result.total}))},onCategory:()=>{g().get("/category/getAllCategory").then((l=>{e.typeData=l.data.result}))},onSearch:()=>{e.onArticlePage()},onRefresh:()=>{e.searchForm={cname:null},e.onArticlePage()},onSizeChange:l=>{e.page.size=l,e.onArticlePage()},onCurrentChange:l=>{e.page.current=l,e.onArticlePage()},onAddArticle:()=>{e.userTitle="添加新闻类型",e.operate=0,e.articleForm={articleId:"",articleName:"",articleUrl:"",author:"",type:"",price:"",count:""},e.articleVisible=!0},onEdit:l=>{e.userTitle="修改新闻类型",e.operate=1,e.articleForm={articleId:l.column.row.articleId,articleName:l.column.row.articleName,articleUrl:l.column.row.articleUrl,author:l.column.row.author,type:l.column.row.type,price:l.column.row.price,count:l.column.row.count},e.fileList=[],e.fileList.push({name:"新闻图片",url:e.articleForm+e.articleForm.articleUrl}),e.articleVisible=!0},onSubmit:async()=>{const l=e.articleRuleForm;l&&(await l.validate(),0==e.operate?g().post("/article/articleSave",e.articleForm).then((l=>{l.data.result&&(u.z8.success({message:"添加成功！",type:"success"}),e.onArticlePage(),e.articleVisible=!1)})):g().post("/article/articleUpdate",e.articleForm).then((l=>{l.data.result&&(u.z8.success({message:"修改成功！",type:"success"}),e.onArticlePage(),e.articleVisible=!1)})))},onDelete:l=>{p.T.confirm("此操作将永久删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let t={articleId:l.column.row.articleId};g().get("/article/articleDelete",{params:t}).then((l=>{l.data.result&&(u.z8.success("删除成功!"),e.onArticlePage())}))})).catch((e=>{console.log(e)}))},uploadImg:l=>{var t=l.file,a=new FormData;a.append("myfile",t),a.append("type","articleImg"),g().post("upload",a).then((l=>{e.articleForm.articleUrl=l.data.result,u.z8.success({message:"上传成功",type:"success"})})).catch((e=>{console.log(e)}))},exportOut:()=>{e.loading=!0,g().get("/article/exportOut",{params:e.searchForm,responseType:"blob"}).then((l=>{e.loading=!1;let t=new Blob([l.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a="新闻信息.xlsx";if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,a);else{let e=(window.URL||window.webkitURL).createObjectURL(t),l=document.createElement("a");l.style.display="none",l.href=e,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(e)}}))},downLoadTemplate:()=>{e.loading=!0,g().get("/article/downLoadTemplate",{responseType:"blob"}).then((l=>{e.loading=!1;let t=new Blob([l.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a="新闻批量增加模板.xlsx";if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,a);else{let e=(window.URL||window.webkitURL).createObjectURL(t),l=document.createElement("a");l.style.display="none",l.href=e,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(e)}}))},exportIn:l=>{var t=l.file,a=new FormData;a.append("myfile",t),g().post("/article/exportIn",a).then((l=>{alert(l.data.result),e.onArticlePage(),e.fileUploadButton.clearFiles()})).catch((e=>{console.log(e)}))}});return{...(0,c.BK)(e)}}},w=t(3744);const h=(0,w.Z)(m,[["render",n]]);var f=h}}]);
//# sourceMappingURL=612.931cb695.js.map